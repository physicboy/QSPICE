# data format Voltage and Coss
d = [
1.0165830334412216, 5997.8886772547485
1.7207361621198884, 5415.626699506733
2.772407996741773, 4889.439332531762
4.322293817836814, 4192.322566496291
6.30957344480193, 3594.156759027096
9.999999999999995, 2815.9624911561746
15.336077187700107, 2263.7272241677224
18.077686769634333, 1578.486740698299
20.61986009502218, 1235.959569427914
22.758459260747877, 1115.0853301187933
30.100341895821302, 968.2053632013066
45.40909610972472, 808.9886539876809
80.75006064040203, 602.1123086360195
143.5961701962213, 484.16642493359683
239.09551442705077, 379.3713228503645
281.8382931264449, 351.24946517537535
372.7593720314938, 293.416146108557
517.9474679231203, 251.52800947930592
756.0864039191291, 218.43674330064604
999.999999999998, 204.9118924231973
1178.7686347935867, 202.3500944838442
];
vstep = 240;
nstep = 5;

for i = 1:nstep
  eoss = 0;
  coss = 0;
  for ii = 1:vstep*i
    for iii = 1:(length(d)-1)
      if (d(iii,1) <= ii)&&(ii <= d(iii+1,1))
        coss = d(iii,2) + ...
        (ii - d(iii,1)) * (d(iii + 1, 2) - d(iii, 2)) / (d(iii + 1, 1) - d(iii, 1));
        break
      endif
    end
    # disp(coss);
    eoss += ii * coss * 1e-12;
  end
  disp([vstep*i eoss]);
end
