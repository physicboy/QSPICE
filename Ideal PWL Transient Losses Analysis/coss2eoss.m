# data format Voltage and Coss
d = [
0, 2850
0.9698140090858006, 2843.4032150929174
2.7118007907638693, 2293.048510593891
4.811032971079778, 1898.399732695351
8.118373418884278, 1299.5847911795172
14.16319668638024, 1047.0728618668154
27.343644868765914, 767.3230940326943
49.33976983123441, 609.9376216828114
86.07459869804913, 498.1401954229802
118.59240028621979, 429.3307772293871
183.88412200264088, 341.1691845484857
299.95395502503845, 253.35022322886013
473.01332739934537, 198.61843703241797
733.4092334866577, 159.9894023969774
1301.0194749963998, 137.95812457508057
];
vstep = 240;
nstep = 5;

for i = 1:nstep
  eoss = 0;
  for ii = 1:vstep*i
    for iii = 1:(length(d)-1)
      if (d(iii,1) <= ii)&&(ii <= d(iii+1,1))
        coss = d(iii,2) + ...
        (ii - d(iii,1)) * (d(iii + 1, 2) - d(iii, 2)) / (d(iii + 1, 1) - d(iii, 1));
        break
      endif
    end
    # disp(coss);
    eoss += ii * coss * 1e-12;
  end
  disp([vstep*i eoss]);
end
